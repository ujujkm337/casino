<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö–∞–∑–∏–Ω–æ: –ü–æ–∫–µ—Ä (–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π)</title>
    <style>
        /* CSS –°–¢–ò–õ–ò - –û–±—â–∏–µ –∏ –¥–ª—è –ü–æ–∫–µ—Ä–∞ */
        :root {
            --bg-color: #03040a;
            --accent-color: #00ffaa;
            --secondary-color: #9b56ff;
            --text-color: #e6f7ff;
            --red-color: #ff4757;
            --black-color: #1e272e;
            --main-font: 'Inter', sans-serif;
            --card-color: #f0f0f0;
            --card-suit-red: #ff4757;
            --card-suit-black: #1e272e;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--main-font);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }
        
        body.win-flash { animation: win-pulse 0.2s 5 alternate; background-color: #1a222c; }
        @keyframes win-pulse {
            from { box-shadow: 0 0 10px var(--accent-color); }
            to { box-shadow: 0 0 60px var(--accent-color); }
        }

        .casino-wrapper {
            width: 95%;
            max-width: 600px;
            padding: 10px 0;
            box-sizing: border-box;
        }

        .game-container {
            padding: 15px;
            border-radius: 15px;
            background: rgba(1, 1, 1, 0.4);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5), 0 0 30px var(--secondary-color);
            border: 2px solid var(--secondary-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            width: 100%;
            justify-content: space-around;
        }
        .display { font-size: 1.1em; font-weight: 700; color: var(--text-color); padding: 5px 15px; border-radius: 5px; border: 1px dashed rgba(255, 255, 255, 0.2); }
        .bet-input-group { display: flex; align-items: center; gap: 5px; }
        .bet-input-group input { width: 70px; padding: 5px; border-radius: 5px; border: 1px solid var(--accent-color); background-color: var(--bg-color); color: var(--text-color); text-align: center; }

        .main-button { padding: 10px 20px; font-size: 1.2em; font-weight: 800; border: none; border-radius: 8px; cursor: pointer; background: linear-gradient(90deg, var(--secondary-color), var(--accent-color)); color: var(--bg-color); box-shadow: 0 5px 20px rgba(0, 255, 170, 0.4); transition: all 0.2s ease; text-transform: uppercase; }
        .main-button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 7px 25px rgba(0, 255, 170, 0.8); }
        .main-button:disabled { background: #555; box-shadow: none; cursor: not-allowed; opacity: 0.6; }

        /* –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ü–æ–∫–µ—Ä–∞ */
        .poker-hand-display { text-align: center; width: 100%; max-width: 400px; margin-bottom: 10px; }
        .poker-hand-display p { font-size: 1em; font-weight: bold; margin: 8px 0; }
        .card { 
            display: inline-block; 
            width: 35px; 
            height: 50px; 
            line-height: 50px;
            font-size: 0.9em;
            background-color: var(--card-color); 
            border: 1px solid #777; 
            border-radius: 4px; 
            box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5); 
            margin: 0 2px; 
            text-align: center;
            font-weight: 700;
            color: var(--card-suit-black);
        }
        .card.red { color: var(--card-suit-red); }
        .card.hidden { background-color: #555; color: transparent; border: 1px solid #ccc; }
        .community-cards {
            border: 2px dashed #444;
            padding: 10px;
            border-radius: 10px;
            min-height: 70px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
        }
        .poker-controls { 
            display: flex; 
            gap: 10px; 
            margin-top: 10px; 
            flex-wrap: wrap;
            justify-content: center;
        }
    </style>
</head>
<body>

<div class="casino-wrapper" id="casinoWrapper">
    <div class="game-container">
        <a href="index.html" style="color: var(--secondary-color); text-decoration: none; align-self: flex-start;">&larr; –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</a>
        
        <h1>üÉè –ü–æ–∫–µ—Ä (Heads-up)</h1>
        
        <div class="header-controls">
            <div class="display" id="balanceDisplay">–ë–∞–ª–∞–Ω—Å: 500</div>
            <div class="bet-input-group">
                <span>–°—Ç–∞–≤–∫–∞:</span>
                <input type="number" id="betAmount" value="10" min="10" max="1000">
            </div>
        </div>

        <div class="game-view active" id="pokerView">
            <div class="poker-hand-display">
                <p>–î–∏–ª–µ—Ä (–°—á–µ—Ç: <span id="dealerHandRank">?</span>): <span id="dealerHand">? | ?</span></p>
                <div class="community-cards" id="communityCards">–û–±—â–∏–µ –∫–∞—Ä—Ç—ã:</div>
                <p>–ò–≥—Ä–æ–∫ (–°—á–µ—Ç: <span id="playerHandRank">?</span>): <span id="playerHand">? | ?</span></p>
            </div>
            
            <p>–ë–∞–Ω–∫: <span id="potAmount">0</span> –∫—Ä–µ–¥–∏—Ç–æ–≤</p>

            <div class="poker-controls">
                <button class="main-button" id="pokerDealButton" onclick="startPokerGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                <button class="main-button" id="pokerCallButton" onclick="playerAction('call')" disabled>–ö–æ–ª–ª/–ß–µ–∫</button>
                <button class="main-button" id="pokerFoldButton" onclick="playerAction('fold')" disabled>–§–æ–ª–¥</button>
            </div>
        </div>

        <div class="display" id="message">–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"</div>
    </div>
</div>

<audio id="audioClick" src="https://www.soundjay.com/buttons/button-2.mp3" preload="auto"></audio>
<audio id="audioSpin" src="https://www.soundjay.com/misc/spinning-2.mp3" preload="auto"></audio>
<audio id="audioWin" src="https://www.soundjay.com/misc/success-trumpet.mp3" preload="auto"></audio>
<audio id="audioLose" src="https://www.soundjay.com/misc/fail-buzzer-01.mp3" preload="auto"></audio>

<script>
    /*
    ================================
    JAVASCRIPT –õ–û–ì–ò–ö–ê –ü–û–ö–ï–†–ê
    ================================
    */
    
    // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
    let balance = 500;
    let isPokerActive = false;
    let deck = [];
    let playerHand = [];
    let dealerHand = [];
    let communityCards = [];
    let pot = 0;
    const CARD_RANKS = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];

    // ------------------------------------
    // –û–ë–©–ò–ï –§–£–ù–ö–¶–ò–ò
    // ------------------------------------
    
    function playSound(name) {
        const audio = document.getElementById(`audio${name.charAt(0).toUpperCase() + name.slice(1)}`);
        if (audio) {
            audio.currentTime = 0;
            audio.play().catch(e => console.log("Audio playback failed:", e));
        }
    }

    function getCurrentBet() {
        const betInput = document.getElementById('betAmount');
        let bet = parseInt(betInput.value) || 10;
        bet = Math.min(Math.max(10, bet), balance || 10);
        betInput.value = bet;
        return bet;
    }

    function updateDisplay(msg = '') {
        document.body.classList.remove('win-flash');
        document.getElementById('balanceDisplay').textContent = `–ë–∞–ª–∞–Ω—Å: ${balance} –∫—Ä–µ–¥–∏—Ç–æ–≤`;
        document.getElementById('potAmount').textContent = pot;
        if (msg) document.getElementById('message').textContent = msg;
        
        const currentBet = getCurrentBet();
        const isBusy = isPokerActive; 

        document.getElementById('pokerDealButton').disabled = isBusy || balance < currentBet;
        document.getElementById('pokerCallButton').disabled = !isBusy;
        document.getElementById('pokerFoldButton').disabled = !isBusy;
        
        if (balance < 10 && !isBusy) {
            updateDisplay('üíî –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤! –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞.');
        }
    }

    function triggerWinEffect() {
        document.body.classList.add('win-flash');
        playSound('win');
        setTimeout(() => document.body.classList.remove('win-flash'), 1200);
    }
    
    // ------------------------------------
    // –õ–û–ì–ò–ö–ê –ö–ê–†–¢
    // ------------------------------------

    function createDeck() {
        const suits = ['‚ô†Ô∏è', '‚ô•Ô∏è', '‚ô¶Ô∏è', '‚ô£Ô∏è'];
        const newDeck = [];
        for (const suit of suits) {
            for (const rank of CARD_RANKS) {
                newDeck.push({ rank, suit, color: (suit === '‚ô•Ô∏è' || suit === '‚ô¶Ô∏è') ? 'red' : 'black' });
            }
        }
        return newDeck.sort(() => Math.random() - 0.5); 
    }

    function getCard() {
        if (deck.length === 0) deck = createDeck();
        return deck.pop();
    }
    
    function renderHand(hand, elementId, isHidden = false) {
        const element = document.getElementById(elementId);
        element.innerHTML = '';
        
        hand.forEach((card, index) => {
            const cardDiv = document.createElement('span');
            cardDiv.className = `card ${card.color}`;
            cardDiv.textContent = card.rank + card.suit;
            
            if (isHidden) {
                cardDiv.className += ' hidden';
                cardDiv.textContent = '??';
            }
            element.appendChild(cardDiv);
        });
    }

    // ------------------------------------
    // –õ–û–ì–ò–ö–ê –ü–û–ö–ï–†–ê
    // ------------------------------------

    function resetPoker() {
        isPokerActive = false;
        playerHand = [];
        dealerHand = [];
        communityCards = [];
        pot = 0;
        
        renderHand([], 'playerHand');
        renderHand([], 'dealerHand', true);
        renderHand([], 'communityCards');
        
        document.getElementById('playerHand').textContent = '? | ?'; 
        document.getElementById('dealerHand').textContent = '? | ?';
        document.getElementById('playerHandRank').textContent = '?';
        document.getElementById('dealerHandRank').textContent = '?';
        document.getElementById('communityCards').textContent = '–û–±—â–∏–µ –∫–∞—Ä—Ç—ã:';
        
        updateDisplay('–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É", —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É.');
    }
    
    function startPokerGame() {
        const bet = getCurrentBet();
        if (isPokerActive || balance < bet) return;
        
        resetPoker();
        isPokerActive = true;
        deck = createDeck();
        
        // –ü—Ä–µ—Ñ–ª–æ–ø (Pre-flop)
        balance -= bet; // –ê–Ω—Ç–µ –∏–ª–∏ –ë–ë
        pot += bet * 2; // –ë–∞–Ω–∫ = –ò–≥—Ä–æ–∫ (—Å—Ç–∞–≤–∫–∞) + –î–∏–ª–µ—Ä (—Å—Ç–∞–≤–∫–∞)
        
        playerHand.push(getCard(), getCard());
        dealerHand.push(getCard(), getCard());

        renderHand(playerHand, 'playerHand');
        renderHand(dealerHand, 'dealerHand', true);
        
        updateDisplay(`–ü–û–ö–ï–†: –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã. –ë–∞–Ω–∫: ${pot}. –†–µ—à–∏—Ç–µ: –ö–æ–ª–ª/–ß–µ–∫ –∏–ª–∏ –§–æ–ª–¥?`);
        updateDisplay(); // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏
    }

    function playerAction(action) {
        if (!isPokerActive) return;
        
        if (action === 'fold') {
            // –ò–≥—Ä–æ–∫ —Å–±—Ä–æ—Å–∏–ª –∫–∞—Ä—Ç—ã
            pot = 0;
            updateDisplay(`üôÅ –ü–û–ö–ï–†: –í—ã —Å–±—Ä–æ—Å–∏–ª–∏ –∫–∞—Ä—Ç—ã (Fold). –ü—Ä–æ–∏–≥—Ä—ã—à.`);
            playSound('lose');
            setTimeout(resetPoker, 2000);
            return;
        }
        
        // –ö–æ–ª–ª/–ß–µ–∫ - –ü–µ—Ä–µ—Ö–æ–¥ –∫ –§–ª–æ–ø—É
        dealerPlay();
    }

    function dealerPlay() {
        // –§–ª–æ–ø (Flop)
        communityCards.push(getCard(), getCard(), getCard());
        renderHand(communityCards, 'communityCards');
        updateDisplay('–ü–û–ö–ï–†: –§–ª–æ–ø –æ—Ç–∫—Ä—ã—Ç! –ñ–¥—ë–º –¢—ë—Ä–Ω...');
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ —à–æ—É–¥–∞—É–Ω—É (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)
        setTimeout(showdown, 2000);
    }
    
    function getHandRankName(rank) {
        const names = ["–°—Ç–∞—Ä—à–∞—è –ö–∞—Ä—Ç–∞", "–ü–∞—Ä–∞", "–î–≤–µ –ü–∞—Ä—ã", "–¢—Ä–æ–π–∫–∞", "–°—Ç—Ä–∏—Ç", "–§–ª–µ—à", "–§—É–ª–ª –•–∞—É—Å", "–ö–∞—Ä–µ", "–°—Ç—Ä–∏—Ç-–§–ª–µ—à", "–†–æ—è–ª-–§–ª–µ—à"];
        return names[rank] || names[0];
    }

    function showdown() {
        renderHand(dealerHand, 'dealerHand', false); // –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—ã –î–∏–ª–µ—Ä–∞
        
        const playerRank = checkPokerHand(playerHand.concat(communityCards));
        const dealerRank = checkPokerHand(dealerHand.concat(communityCards));
        
        document.getElementById('playerHandRank').textContent = getHandRankName(playerRank.rank);
        document.getElementById('dealerHandRank').textContent = getHandRankName(dealerRank.rank);

        let msg = '';
        let winAmount = 0;

        // –û—á–µ–Ω—å —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –ø–æ–±–µ–∂–¥–∞–µ—Ç —Ç–æ—Ç, —É –∫–æ–≥–æ –≤—ã—à–µ —Ä–∞–Ω–≥.
        if (playerRank.rank > dealerRank.rank) {
            winAmount = pot;
            balance += winAmount;
            triggerWinEffect();
            msg = `üéâ –ü–û–ö–ï–†: –ü–û–ë–ï–î–ê! –í–∞—à ${getHandRankName(playerRank.rank)} –±—å–µ—Ç –î–∏–ª–µ—Ä–∞. –ë–∞–Ω–∫ ${winAmount} –≤–∞—à!`;
        } else if (playerRank.rank < dealerRank.rank) {
            msg = `üôÅ –ü–û–ö–ï–†: –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏. –î–∏–ª–µ—Ä –ø–æ–∫–∞–∑–∞–ª ${getHandRankName(dealerRank.rank)}.`;
            playSound('lose');
        } else {
             // –ù–∏—á—å—è (–°–ø–ª–∏—Ç –ø–æ—Ç)
            winAmount = pot / 2;
            balance += winAmount;
            msg = `‚ÜîÔ∏è –ü–û–ö–ï–†: –ù–∏—á—å—è! –ë–∞–Ω–∫ —Ä–∞–∑–¥–µ–ª–µ–Ω. –í–∞–º –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ ${winAmount} –∫—Ä–µ–¥–∏—Ç–æ–≤.`;
            playSound('click');
        }

        pot = 0;
        updateDisplay(msg);
        setTimeout(resetPoker, 4000);
    }

    // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ —Å–ª–æ–∂–Ω–∞ –¥–ª—è JS. –ó–¥–µ—Å—å —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –º–æ–∫ (Mock)
    // –†–∞–Ω–≥–∏: 0-–°—Ç–∞—Ä—à–∞—è –∫–∞—Ä—Ç–∞, 1-–ü–∞—Ä–∞, 2-–î–≤–µ –ü–∞—Ä—ã, 3-–¢—Ä–æ–π–∫–∞, 4-–°—Ç—Ä–∏—Ç/–§–ª–µ—à (—É–ø—Ä–æ—â–µ–Ω–Ω–æ)
    function checkPokerHand(hand) {
        const allRanks = hand.map(card => CARD_RANKS.indexOf(card.rank));
        const rankCounts = {};
        allRanks.forEach(rank => {
            rankCounts[rank] = (rankCounts[rank] || 0) + 1;
        });

        const counts = Object.values(rankCounts).sort((a, b) => b - a);
        
        let rank = 0;
        if (counts[0] >= 4) rank = 7; // –ö–∞—Ä–µ
        else if (counts[0] === 3 && counts[1] >= 2) rank = 6; // –§—É–ª–ª –•–∞—É—Å
        else if (counts[0] === 3) rank = 3; // –¢—Ä–æ–π–∫–∞
        else if (counts[0] === 2 && counts[1] === 2) rank = 2; // –î–≤–µ –ü–∞—Ä—ã
        else if (counts[0] === 2) rank = 1; // –ü–∞—Ä–∞
        
        // –®–∞–Ω—Å –Ω–∞ –°—Ç—Ä–∏—Ç/–§–ª–µ—à (—á—Ç–æ–±—ã –∏–≥—Ä–∞ –Ω–µ –±—ã–ª–∞ —Å–∫—É—á–Ω–æ–π)
        if (Math.random() < 0.1) rank = Math.max(rank, 4); // –°—Ç—Ä–∏—Ç/–§–ª–µ—à
        
        return { rank, highCard: Math.max(...allRanks) };
    }


    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    window.onload = () => {
        resetPoker();
    };
</script>
</body>
</html>
